航空计测技术
Aviation　Metrology　&　Measurement　Technology
1999年 第19卷 第3期 Vol.19 No.3 1999



最小二乘参数估计若干问题的讨论
周维虎　费业泰　丁叔丹
摘　要　讨论了最小二乘估计中应注意的几个问题，指出了最小二乘估计的一些新的研究和应用方向。
关键词　最小二乘　参数估计　精度预测　稳健估计
Discussion on Some Problems about the Use of Least Square Parameter Estimation
Zhou Weihu　Fei Yetai　Ding Shudan
Abstract　Some attentive problems involved in least square(LSQ) parameter estimation are discussed in this paper.The new research and application trends about LSQ are pointed out as well.
Key words　LSQ,Parameter estimation,Precision prediction,Robust estimation
　　在各种工程测量中，最小二乘参数估计不受测量值误差分布的影响，因而是一种有效的方法，得到了广泛的应用。但也会出现一些问题，使最小二乘法的应用受到影响，如：随着参数的增加，解算效率和解算精度下降；参数相关或复相关导致法方程奇异；粗差对参数估计影响较大等。本文提出若干问题加以讨论。
1　基本原理
　　使用最小二乘法估计参数时，首先应列出误差方程式。设有n个测量方程

误差方程为

式中，

误差方程的矩阵形式为 V＝AX＋l
当测量值L相互独立时，其权阵P是对角阵。
法方程为　ATPAX＋ATPl＝0 (2)
参数的最佳估计值为　X＝－(ATPA)－1.(ATPl)＝－N－1.U(3)
式中，N＝ATPA　U＝ATPl
当误差方程为非线性时，设vi＝fi(x1，x2，…，xt)－Li (i＝1，2，…，n)
按泰勒公式展开，略去二次以上的高次项，得

按线性方程处理，解得δxj(j＝1，2，…，t)
参数解　　　　　　　　xj＝x0j＋δxj　　
以下讨论仅限于线性参数最小二乘估计。
2　若干问题的讨论
2.1　初值的选定
　　测量中，经常会出现误差方程中常数项有效数字位数较多的情况，因此，法方程常数项的数字位数也较多，使后续计算难度增加。此时，可引入未知数近似值加以简化。
令　xj＝x0j＋δxj (j＝1，2，…，t)
代入(1)式得

　　vi＝aiδx1＋biδx2＋…＋tiδxt＋li (5)
式中，li＝aix01＋bix02＋…＋tix0t＋di－Li
　　　　＝L0i－Li
矩阵形式　V＝AδX＋l　　
　　应注意的是，参数近似值一旦选定，不能再变动。否则，将得不到正确的估计结果。其次，由于引用了参数近似值，误差方程(5)中常数项li有效数字变少。为了计算方便，计算单位应作相应调整，选用测量值最小单位作为计算单位。
　　当参数模型为非线性时，误差方程需在x0j处展开成线性模型，若x0j给的不准，会影响计算精度。因为，只有当δxj很小时，高次项才可忽略不计。一般先通过少量数据或其它简单公式得到近似值。
　　例如：在球面拟合中，当(xi，yi，zi)为球面上的均匀采集点时，球心坐标和半径(球面拟合中的待估参数)的近似值可取为近似圆心到第i点的距离。也可以采用多次迭代。此时，参数的最后估计结果为

中等式右端分别为xj的初值、第一次、第二次、…第n次迭代结果。
2.2　待估参数的选取
　　最小二乘参数估计中，未知数个数应等于待估参数的个数，且应相互独立，当未知数之间相关时，法方程(2)中ATPA奇异，法方程无确定解。因此，要使法方程有确定解，ATPA应非奇异，即A阵中不能有相关项。拟定测试方案时，应使未知数足数且相互独立。万一系统参数或待估参数过多，导致相关或复相关，应对系统参数进行比较和优选。或者，通过检查A阵，发现相关列则去掉这些列，将列中待估参数当成零处理。在最小二乘参数估计中，过度选取参数极易造成相关，这一点使用时需加以注意。
　　例如:在机器人空间定位误差补偿时，需识别关节几何误差参数。每个关节有三个旋转参数，三个移动参数。若有n个关节，待估参数总数为6n个。因此，当n较多时，极易造成相关或复相关。对某台RM—501五关节机器人研究发现，在总共30项待估参数中，仅有15项参数独立，其余15项相关或复相关。
2.3　参数及其函数的精度评定
2.3.1　单位权标准偏差σ0＝([pvv]／(n－t)1／2 (7)
式中，n为测量值个数；t为未知数个数。
[pvv]值可根据剩余误差直接求得　vi＝aiδx1＋biδx2＋…＋tiδxt＋li (i＝1，2，…，n)也可按下式求得


顾及ATPV＝0，得

ATPl是(2)中的常数项矩阵。
顾及(3)式得
　　
　　可以看出，由(8)式计算[pvv]较之先计算vi再计算[pvv]要简便得多。[pvv]的两种计算方法可相互核验。
　　单位权标准偏差求得后，还需给出参数及其函数的权倒数，才能计算出它们的精度。
2.3.2　参数的权倒数及其标准偏差
最小二乘估计参数的权倒数为　Qxx＝N－1 (9)
它是法方程系数阵的逆阵,所以，参数的标准偏差

2.3.3　参数函数的权倒数及其标准偏差
　　设测量结果表示成参数的函数，其关系式为F＝f(x1，x2，…，xt)
函数F的权函数式为

按协因素(权倒数)传播律，得

(12)式中q＝N－1．f等价于　N．q－f＝0 (13)
在(12)、(13)式中，q＝(q1，q2，…，qt)T。由(13)式可以看出，只要将法方程(2)中的常数项换成f，解法方程即可求得q。最后，参数函数F的标准偏差
　　
　　由上述推导可以看出，参数的权倒数阵Qxx无论对于参数精度或是参数函数的精度都具有重要意义。
2.3.4　待估参数的精度预测
　　前已说明，待估参数的精度取决于权系数阵N－1，而N－1＝ATPA仅由误差方程系数和测量值L的权决定，与测量值无关。这样，在实施测量之前，就有可能利用误差方程系数阵(由具体问题决定)求得N－1。根据N－1可以知道某估计量的权倒数，从而事先预测该参数的精度。
　　另外，在知道N－1的情况下，一旦测量值拿到以后，就可以迅速计算参数值，从而大大提高了测量效率。
2.4　粗差检验
　　最小二乘参数估计遵循VTPV＝min准则，估计结果容易受到粗大误差的影响;因此，在测量过程中和参数估计之后尤其应注意粗差检验。粗差检验首先要构造与残差有关的统计量，然后进行粗差的整体检验和单个检验。整体检验一般可用F分布或χ2分布检验法。检验通过说明所有测量值均不含有粗差，检验不通过则需对测量值进行单个粗差检验。一般选统计量

式中，qii为残差V的权倒数阵Qvv的对角线元素。

　　根据选定的显著水平α，查正态分布表的双侧检验临界值zα，若｜zi｜＜zα，认为该测量值不含有粗差。否则，应剔除该测量值，重新解算。
　　值得一提的是，为了抑止粗差的影响，人们提出了稳健估计(也称抗差估计)，它可以有效减小粗差对参数估计的影响。
2.5　稳健估计
　　稳健估计(Robust Estimation)的含义是，在估计过程中自动进行粗差剔除，使参数估计结果不受含有粗差的测量值影响。稳健估计最具代表性的有选择权迭代法和P—范最小法。
　　选择权迭代法的思路是，从最小二乘估计开始，每次迭代估计后，根据残差大小和选择的权计算每个测量值在下一步迭代计算中的权值。如果权函数选择适当，含有粗差的测量值的权将越来越小，直至趋于零。迭代中止时，参数估计结果将不再受粗差影响。选择权迭代法的准则为

式中，pni为第n次迭代时，第i个测量值的权。计算公式为

f(vi)为测量值Li的权函数，它是残差vi的函数。权函数的选择有不同的方法，如丹麦法、李德仁法等等。应根据具体测量对象而定。
　　稳健估计另一种典型方法是P—范最小法，也称LP法。该估计的准则为

　　当测量误差服从P—范分布时，参数估值与极大似然法估计值一致。一般常取P＝1～1.5，当P＝1时，即为绝对值最小和法。绝对值最小和法被认为具有较好的粗差识别能力，但估计效率很低。最好的办法是将各种估计方法组合起来，以充分发挥各自的优势。如基于I—范解的加权最小二乘估计，就具有较强的粗差剔除能力和良好的统计特性，是一种比较好的稳健估计法。
3　结束语
　　随着理论研究和应用的深入，新的计算方法不断发展。对于线性最小二乘问题，传统的方法是从构造法方程入手，而新的算法则试图直接从矛盾方程入手，避免了法方程的缺陷。非线性最小二乘问题的发展也很迅速。在参数直接估计的基础上，又出现了各种带约束条件的最小二乘问题。这些问题不仅存在于工程当中，而且也大量存在于诸如统计、数学规划、经济、控制、最优化以及社会科学的各个领域。特别是随着计算机、矩阵代数、概率统计理论的组合应用，产生了现代参数估计理论。
　　关于现代参数估计理论，首先是测量值广义化导致了相关参数估计，其次是秩亏参数估计，随后又出现了最二乘推估，它将随机过程也作为未知数包含在模型之中。此外，针对最小二乘法的局限，又出现了抗差估计方法，即各种稳健估计和有偏估计。上述方法有效地改进和完善了最小二乘法。关于近代最小二乘估计超出了本文范围，不作深入讨论。
作者简介：36岁　男　高级工程师
作者单位：周维虎　费业泰　丁叔丹　(长城计量测试技术研究所，北京市，100095)
参考文献
　　1　费业泰.误差理论与数据处理.北京:机械工业出版社,1995
　　2　於宗寿.测量平差基础.北京:测绘出版社,1984
　　3　李广云.工业测量系统.北京:解放军出版社,1994
　　4　夏凯等.机器人控制.北京:清华大学出版社,1994
　　5　刘钦圣.最小二乘问题计算方法.北京:北京工业大学出版社,
收稿日期：1998-10-09
