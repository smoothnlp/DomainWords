宇 航 学 报
JOURNAL OF ASTRONAUTICS
1998年  第3期   No.3 May   1998
科技期刊
基于神经网络模型的伺服系统控制
与补偿方法研究

徐立新
(北京理工大学自动控制系*北京*100081)
王常虹　庄显义
(哈尔滨工业大学控制工程系*哈尔滨*150001)
　　摘　要　本文从两个角度提出使用神经网络模型提高伺服系统的控制精度。首先,分析了扰动力矩对精密伺服系统的影响。提出使用神经网络方法建立扰动力矩的数学模型,并根据全补偿原则设计补偿环节,实现扰动力矩的动态补偿。进而考察一类非线性伺服系统对象,研究使用神经网络模型实现对象逆动态模型的在线辩识和控制,在实验室条件下进行了神经网络伺服系统补偿控制的实验研究。试验结果表明这种新的补偿方法对提高伺服系统的精度十分有效,具有实际应用价值。
　　主题词　伺服系统　神经网络　扰动力矩　逆系统　实时控制
CONTROL AND COMPENSATION FOR NONLINEAR 
SERVO SYSTEMS BASED ON NEURAL NETWORKS

Xu Lixin
(Department of Automatic Control,Beijing Institute of Technology*Beijing*100081)
Wang Changhong　Zhuang Xianyi
(Department of Control Engineering,Harbin Institute of Technology*Harbin*150001)
　　Abstract　Neural network is used for servo systems design in two ways.The affection of disturbing moment in servo systems is discussed at first,we use feedforward neural network to build the mathematic model of disturbing moment,and design transfer function for compensation.Then,the schemes of training inverse dynamic model is provided.By means of neural networks model,the control properities of the servo system with unknown parameter are improved greatly after online learning course.Experimental results show that the new method is effective in identification and control of servo systems.
　　Key words　Servo systems　Neural network　Disturbing moment　Inverse systems　On-line control
1　引　言
　　精密伺服系统已被广泛应用于航天控制领域,如惯性导航设备中的测试转台,导弹半实物仿真中的仿真转台,红外目标背景模拟装置中的光学随动系统等等。但是,在伺服系统的控制中仍存在一些问题:首先,伺服系统精度的提高受到以摩擦力矩为主的扰动力矩的限制。扰动力矩造成伺服系统的死区非线性,使角分辨率及重复精度降低,甚至影响伺服系统的低速特性。其次,当被控对象非线性严重,特别是当一部分非线性模型参数未知时,要满足高精度、高频响等性能,常规的控制算法受到一定的局限。因此,研究提高伺服系统控制性能的新方法具有重要的理论和实际意义。
　　近年来,神经网络理论及应用的研究展示出它在表达非线性系统方面的灵活结构和能力,以及自组织、自适应、自学习的特点。基于神经网络模型的控制方法显示出较好的性能,在机器人、倒摆等领域中取得了成功的应用［1］。本文以神经网络模型为出发点,首先应用神经网络技术建立扰动力矩模型,使用补偿环节实现扰动力矩的动态补偿。进而考察一类非线性伺服系统对象,研究使用神经网络模型实现对象逆动态模型的在线辩识和控制。在实验室条件下进行了神经网络伺服系统补偿控制的实验研究。
2　理论准备
2.1　扰动力矩分析
　　精密伺服系统中的扰动力矩主要是摩擦力矩,此外还有负载阻转力矩。摩擦力矩的大小与电机结构,润滑特性,负载大小和速率有关。负载阻转力矩主要与负载有关。由于扰动力矩是提高伺服系统精度的主要障碍,已有许多学者在这一领域做了大量工作,取得了一些成果［2,3］。
　　1)分段线性模型。

(1)
其中MS与MC分别为最大静摩擦力矩和库仑摩擦力矩,MF为转台运行过程中对应速率ω所测得的摩擦力矩。
　　2)慢变常值模型,即认为摩擦力矩在一定范围内是常值。

(2)
　　文献［3］根据上述摩擦力矩模型设计状态观测器,使用不变性原理进行前馈补偿,切实提高了转台系统的静态跟踪精度。但是,文献［2］中仅考察了常值阻转力矩作为扰动力矩。文献［3］给出摩擦力矩的分段线性模型。由于近似模型比较粗糙,不能如实反映摩擦力矩的真实情况,当摩擦力矩处于过零和零附近的过渡过程状态时,难以获得有效结果。综上所述,能否同时考虑摩擦力矩和负载阻转力矩并建立较为精确的摩擦力矩和负载阻转力矩模型是提高伺服系统精度的关键问题。
2.2　逆动态模型存在性
　　考察一般非线性动态系统
(3)
其中状态x∈Rn,控制u∈Rm,输出y∈Rr,f(*　,　*)h(*　,　*)为相应维数非线性函数。
　　定义1［4］对于由式(3)所表示的系统∑:u→y,若存在一个相应的系统∏:r→w使得当r(t)=y(t)时,有等式w(t)=u(t)成立,则称系统∏是系统∑的左逆系统,称系统∑是左可逆的,简称可逆。
　　定义2［4］对于单输入、单输出系统,即式(3)中m=1,r=1,系统的相对阶数a(Σ)是能使下式成立的最小正整数。
　
　　引理1［4］对于单输入、单输出系统Σ,m=1,r=1,系统为可逆的充分必要条件是相对阶数a(Σ)≤n。
　　根据上述定义和引理,可以得到
　　定理1:对于由

(4)
描述的单输入、单输出非线性伺服系统,其中R(*)＞0,其逆动态系统一定存在。
　　证明:令x1=θ,x2=
则,式(4)的状态方程描述为

即有　　　　　　　a(Σ)=2=n
由引理1可推出系统式(4)可逆。
证毕。
3　扰动力矩的动态补偿
3.1　扰动力矩建模方法
　　本文设计较为简单的前向网络,利用其逼近非线性函数能力,建立起扰动力矩的数学模型。由于扰动力矩主要是摩擦力矩和恒值负载阻转矩,忽略随机扰动力矩影响,可认为当系统和负载一定时,扰动力矩F(ω)是速率(ω)的非线性函数。显然这是一静态过程。使用前向神经元网络建立起这一非线性模型。为使训练方便,分别对于正转(ω＞0)和反转(ω＜0)建立神经网络模型。由于分别逼近较为简单的非线性函数,网络权值训练容易收敛。选用多层前向网络实现,设计每个网络含一个输入节点,一个输出节点,根据样本数量,选用8个隐节点。隐节点激励函数为双曲正切函数tanh(x)=(1-exp(-2x))/(1+exp(-2x)),输出节点激励函数为线性函数。网络结构建立以后,设计试验获得输入为速率,输出为扰动力矩的数据样本。给定某恒值角速率ω,测量电机电枢电流I。已知电机力矩平衡关系式:

其中KM为转矩常数。因速率为定值,(dω)/(dt)=0,即有KMI=F(ω)。即可由电枢电流换算出扰动力矩F(ω)。这样就得到一组数据样本(ω,F(ω))。以cccccccc此作为教师训练多层前向网络权值。为保证训练网络的有效性,训练样本数据应覆盖较大范围。
3.2　补偿装置设计
　　网络权值经离线训练后,即获得扰动力矩的神经网络模型。与摩擦力矩分段线性模型相比:低速段表现为光滑的非线性曲线,高速段接近线性关系。
　　伺服系统及补偿环节设计如图1所示。实时采样测速反馈信号,通过神经网络模型计算扰动力矩的大小,为实现扰动力矩的全补偿,计算补偿环节传函为:



图1　扰动力矩补偿系统结构
若使用硬件电路网络实现,可在原传函基础上增加一个具有较小的时间常数的惯性环节。本文中,由于神经网络模型及前馈补偿均在计算机中以软件实现,传函φ(s)容易由编程实现。
4　控制对象逆动态模型建立及控制
4.1　建模方法
　　采用多层前向网络来建立系统逆动态模型,对象的角位置θ,角速度,角加速度作为网络输入,用网络输出U逼近控制输入量Ud。
　　从系统辩识的角度来考虑,用作网络学习的样本集合最好由白噪声激励系统而产生,但是为了限制网络的规模(即隐层的数量与隐层神经元的数目)和减少网络的学习时间,这里选用多个不同频率正弦信号相复合的方式作为网络学习的预期位置信号。
　　考虑到对象是一个如式(4)所示的实际伺服系统,其中参数未知,1～4Hz为主要工作频带,从原理上讲,预期位置信号应覆盖这个频带范围,同样为了具体实现的方便性,只选用两个信号频率复合成预期位置信号,对于更复杂的预期位置信号,只需更复杂的网络结构和更长的训练时间即可以实现。预期位置信号频率为f1=2Hz,f2=3.33Hz,幅值均为18°,则预期位置信号可写作:
θr=18°sin(2π*2*t)+18°sin(2π*3.33*t)
将θr信号加入到网络闭环训练结构中,可获得系统实际信号:位置信号θ,测速信号,控制信号u。用y,v,a来表示θ,,,这样网络训练样本由对象的位置信号y,速度信号v,加速度信号a及控制信号u构成,其中y,v,u可直接测得。a可直接对速度信号微分获得,但是由于测速机实际信号噪声很大,引起加速度计算严重失真,而且,现场也缺乏加速度计等设备,本文使用“跟踪-微分器”［5］来获取加速度信号。需要指出的是使用“跟踪-微分器”获取加速度信号,可以离线进行,也可以在线递推实现,因而是一种较好的获取加速度方法。不足之处在于,不同情况下需要反复调整、验证其参数R和δ。
4.2　逆动态控制系统组成结构


图2(a)　控制系统组成结构


图2(b)　控制系统对f=2Hz
正弦信号响应
控制对象是一个实验系统,将包含测速机在内的速度环视作广义对象,实验不要求确切知道对象的模型结构和参数,只须对象可逆即可。
　　控制系统的组成如图2(a)所示。
　　其中位置传感器采用电位器,角位置传感器满量程输出为5V,对应180°位置,最小电压分辩率为0.01V,控制信号和位置传感器信号经过HY-1232数据采集板进出计算机。接口板提供32路单终端的数据采集通道,其性能达到±0.03%的精度和12位的分辩率。此外,此板还带有一个12位分辩率的模拟输出通道,可插入计算机扩展槽,直接与PC总线交换数据。本实验研究中使用中断来处理数据采集和实时控制。因为神经网络参与控制律的计算,因此必须保证在一个采样时间内完成大量的计算任务,所以,选用计算机为486/DX-66,程序中采样时间为10ms。不须辩识伺服对象模型,直接使用PID法整定控制系统,控制系统对f=2Hz,幅值18度(0.5V)的正弦信号响应如图2(b)所示。
4.3　反馈误差学习控制原理及改进
　　反馈误差学习控制是一种基于神经网络的自适应控制方法。最早由kawato［6］提出并应用。它使用闭环系统的反馈误差量调整神经网络权值,目标是极小化反馈误差,从而在线辩识对象逆动态模型,实现高精度的位置控制。反馈误差学习控制结构如图3所示。


图3　反馈误差学习控制结构
其由神经网络逆动态前馈控制器,控制对象,及常规反馈控制器组成。常规反馈控制器作为一般的反馈控制器以保证在学习期间系统的渐近稳定性,常规控制器输出作为误差信号用来调整神经网络权值。

(5)
　　反馈误差学习控制是一种在线控制方法。在学习过程中,由反馈误差不断调整的神经网络前馈控制器逐渐取代常规反馈控制器而发挥主要作用,当反馈误差趋近于零时即实现了输出完全跟踪输入的理想逆动态控制。
　　反馈误差学习控制在控制的同时又进行学习,并且利用学习获得的信息进一步实现优化控制。当对象模型较稳定时,反馈误差学习控制可进一步提高辩识的逆动态模型精度;当对象发生摄动或系统受到持续扰动时,反馈误差学习方法能够有效调整网络权值,自适应辩识逆动态模型参数。从这个角度上来讲,反馈误差学习控制是一种先进的、强鲁棒性的控制方法。
　　采用式(5)给出的权值调整方法,在实验中发现有两点不足。首先,梯度方法的局部极小问题有时出现,使得学习过程陷于停止状态。其次,每次调整权值的计算量偏大,计算时间较长,占用过多系统资源。为此,采用启发式随机训练算法［7］改进权值调整方法式(5)。
　　令Wij为神经元i和神经元j间的连接权,在第k步迭代:

其中

(6)
δ为一小正数。概率Pij（k)为

(7)
其中Cij(k)定义与原算法不相同,在此,

(8)
其中

这里,网络逼近误差与权值变化的相关量为Cij(k),实验结果表明改进后的随机权值调整方法是一种非常有效的训练算法,能够切实降低系统反馈误差,并在较短的时间内完成实时计算。
5　实验结果
5.1　扰动力矩补偿试验结果
　　由于扰动力矩主要影响伺服系统的低速跟踪特性及定位精度,本文重点考察补偿前后这两个指标的变化情况。设计试验使系统跟踪恒定速度信号,并考察其定位精度。试验以红外目标背景模拟装置中的光学随动系统为对象,采用对比方法,对引入扰动补偿前后的误差进行比较。首先选择区间［-0.5,0.5］内的20个均匀分布的速率样本(单位rad/s)训练网络权值,测试信号为速率0.1rad/s的低速斜坡信号,比较补偿前后系统的跟踪精度,在跟踪过程中再给出定位信号,试验结果如图4(a)和图4(b)所示,其中,图4(a)是补偿前的误差曲线,图4(b)是补偿后的误差曲线。在每条曲线中,前半记录了对于斜坡信号的跟踪误差,后半段为定位误差,其中较大跳跃是由于试验状态切换引起的。试验结果表示:


图4(a)　补偿前误差曲线


图4(b)　补偿后误差曲线
1.跟踪误差由于0.3mrad减小到低于0.1mrad。
　　2.稳态误差由0.1mard降低到接近无静态。
　　此外,对于神经网络模型补偿范围内的其他速率信号,补偿控制均可明显降低跟踪误差,降低系统死区电压。试验结果表明本文所提出的补偿方法切实提高了伺服系统的低速跟踪精度和定位精度。
5.2　逆动态在线学习控制实验结果
5.2.1　模型逼近
　　设计神经网络逆动态模型输入层含3个节点,分别表示对象的位置θ,角速度和角加速度。输出层只含一个节点,表示系统控制量u,隐层含15个隐节点,隐节点激励函数为

　　在已获得的数据中截取200个作为网络训练样本,对样本数据进行归一化处理,设归一化处理后的样本表示为{θ1,1,1,u},其中



图5　逆动态模型逼近结果
由于控制量u本身比较小,在±2范围变动,故不须归一化处理。归一化处理对网络权值训练非常重要,其能够有效提高网络学习速度,减少训练时间。将训练样本归一化处理后,经过长时间学习后,网络的逼近结果如图5所示,其中u1(k)为实际控制作用,用点线表示。u2(k)为网络逼近输出,以实线表示。
5.2.2　单一频率信号的在线学习控制
　　考察正弦信号f=2Hz,幅值0.5V,采用反馈误差学习控制,经在线学习1000次后的控制结果如图6所示。


图6(a)　　　图6(b)

]
图6(c)　　　图6(d)


图6(e)
图6　f=2Hz正弦信号在线学习控制结果
其中图6(a)为在线学习后的系统响应,yr(k)为理想输出,y3(k)为系统响应。图6(b)为在线学习后的跟踪误差,将图6(a)与图2(b)相比较,可以发现经过在线学习后系统输出对给定输入几乎没有相位滞后,跟踪误差由峰峰值0.5V减小到0.23V(图6(b))。
　　由于加到对象的控制作用由两部分组成,即神经网络逆动态前馈控制器输出和常规反馈控制器输出,在线训练前后二者比较如图6(c)和图6(d)所示。其中un1(k)和un2(k)表示在线训练前后神经网络前馈控制器输出,up1(k)和up2(k)表示常规控制器输出。比较图6(c)和6(d)可见,在学习过程中,神经网络前馈控制器逐渐取代常规反馈控制器的作用,真正实现了逆动态控制的目的。
　　使用启发式随机训练算法的在线训练误差曲线如图6(e)所示。显然按算法获得了较为理想的学习效果。
5.2.3　复合频率信号的在线学习控制
　　选择理想位置信号
θr=9°sin(2π*2*t)+9°sin(2π*3*t)


图7　复合频率信号在线学习控制结果
经2000次在线学习后结果如图7所示。
　　对图7进行分析,虽然在线学习进行了2000步,但对象跟踪结果较单一频率信号情况要差很多,说明复合频率信号在线学习是比较复杂的,需要花费数倍的学习训练时间。其次,由于权值要对两个信号进行调整,增加了权值调整变化的复杂性。
6　结　论
　　本文从两个角度提出使用神经网络模型提高伺服系统的控制精度。给出了神经网络在伺服系统中应用的实验室结果。首先,用神经网络方法建立起扰动力矩的数学模型,与以前的分段线性模型和常值型相比,更能够真实反映扰动力矩的变化过程。然后依据全补偿原则设计补偿环节传递函数,补偿环节结构简单,容易实现。试验结果表明这种新的补偿方法是可行和有效的。若用其补偿更精密的伺服系统,效果会更加显著。本文所述方法同样适用于其它类型扰动力矩(如负载偏心力矩)的动态补偿。其次,针对伺服系统模型未知情况,进行了基于前向网络的逆运态模型训练和伺服系统逆动态实时控制器设计,给出了神经网络应用的实验室结果。研究表明本文所给出的神经网络学习控制是一种先进,可行的控制方法,其能够有效拓展系统频带,显著改善控制系统跟踪性能。但是,本文中未考虑随机扰动力矩的影响。实际伺服系统中,扰动力矩也是角位置和时间的随机函数。较大的随机波动将严重影响伺服系统的精度。此外,最优激励信号和更加快速实用的学习算法也是需要进一步深入研究的问题。
参考文献
1　Kawato M,Furukawa K,Suzuli R.A Hierarchical Neural Network Model for Control and Learning of Voluntary Moment.Biological Cybernetics.1987,57(2):169-185
2　高龙,熊光愣,梁德全.状态观测器在调速系统中的应用.清华大学学报,1980,20(4):33-46
3　杨元恺,郎需英.精密转台中摩擦力矩的动态补偿.自动化学报,1983,9(4):248-252
4　李春文,冯元琨.多变量非线性控制的逆系统方法.清华大学出版社,1991,pp30-94
5　韩京清,王伟.非线性跟踪—微分器.系统科学与数学.1994,14(2):177-183
6　Kawato M,Gomi H.Neural Metwork Control for A Closed-Loop System Using Feedback-Error-Learning.Neural Networks.1993,6(6):933-946
7　徐立新,王常虹,庄显义.神经网络训练的一种随机算法.哈尔滨工业大学学报.1997,29(3):85-87
