环境技术
ENVIRONMENTAL TECHNOLOGY 
1999年  第4期  No.4 1999



VSS算法用于抑制心电图中50Hz干扰
杜丽冰 
摘要：由于可变步长LMS(VSS)算法能有效地改善LMS算法存在的收敛速度与收敛误差之间的矛盾，因此可以显著地提高对干扰的抑制性能。为进一步改善心电图（ECG）中的50Hz干扰的抑制性能，本文应用VSS算法。通过模拟实验分析了参数与抑制性能的关系，并从各方面与LMS算法和其它改进的LMS算法进行比较。 
关键词：心电图；可变步长LMS算法；50Hz干扰；抑制性能
中图分类号：TN911.4　　文献标识码：A
VSS Algqrithm for Suppression 50Hz Interference 
in Electrocardiogram
DU Li-bing
 (BOX.171 Beijing Univ.of Post & Telecom,Beijing 100876) 
1前言
　　为有效地抑制心电图（ECG）中的工频50Hz干扰，除了在干扰抑制器的结构上采用特殊的最简单的两个权的凹口滤波器的自适应干扰对消器（AIC），并考虑采用更有效的自适应算法。经典的LMS算法虽简单、运算量小和收敛性能稳定，但存在收敛速度与收敛误差之间的矛盾，因此要得到最佳的抑制性能比较困难。为更有效地抑制50Hz干扰，在[1]中采用了变动量LMS（VMS）算法，通过计算机模拟实验，在相同条件下分析比较了LMS和VMS算法的抑制性能。从结果表明VMS算法较之LMS算法收敛速度改善了近一半，但收敛误差仅改善了1.8dB，因此抑制性能还不够理想，故本文提出采用VSS算法［2］以进一步提高抑制性能 。经计算机模拟实验也说明了VSS算法对于有用信号的幅度变化的动态范围较大的ECG信号的跟踪能较强，抑制性能优于LMS算法和其它的LMS改进算法。
2ＶＳＳ算法
　　本文仍采用[1]中的最简单的两个权的凹口滤波器自适应干扰对消器（AIC）抑制ecg中的50Hz干扰，它的结构如图1所示。

图1AIC的原理图 
　　图中原始输入d(t)=S(t)+no(t)，  
其中S(t)为ECG信号，no(t)为50Hz干扰，AUC中的自适应滤波器（AF）的参考输入为50Hz的干扰源n1(t)=X(t)，它们均以取样周期T取样，在k时刻的取样值分别为Sk、nok、n1k、dk，Sk与nok、n1k不相关，但nok与n1k相关，这里考虑两者的幅度有关。
　　AIC的输出或误差信号ek=dk-yk，其中
　　yk为AF的输出，W1k、W2k为权值取样值。
 本文中自适应算法采用VSS算法。 
　　VSS算法使步长因子随e2k变化而变化，权值调整公式如下［２］ 
　　Wk+1=Wk+μkＸkek (1)
　　μk+1=αμk+γe2k(2)
其中0＜α＜1，γ＞0
 由(2)式可见，μk总为正，并由ek和两个常量α、γ来控制。在权值调整开始时， ek较大，μk也较大，以快速跟踪达到快速收敛。收敛后ek减小，μk也随之减小，失调也减小。衡量收敛误差的稳态失调M经推导为
　　M=(1-B)/(1+B) (4)
其中B=［1-2tr［R］(3-α)γξmin/(1-α2)］1/2 
其中ξmin为均方误差MSE=E［e2k］=ξk的最小值，tr[R]为R的迹，R=E［XkXTk]。由（2）式可见，M随着α和γ减小而减小。为使M小，α、γ应尽可能小，但为保证跟踪的自适应能力，也不能太小。为保证MSE总有界，μmax的充分条件为μmax ≤2/(3tr[R])。初始步长μo选为μmax，μmin的选择以提供最小跟踪能力，通常按LMS算法中的μ值。由（1）、（2）式可见，VSS算法由于μk的变化直接与ek有关，且有两个可调参数、所以跟踪能力和失调较之LMS算法和其它LMS改进的算法均有较大的改善，通过模拟实验也证实了。 
3计算机模拟及分析
　　为便于与LMS算法和其LMS改进的算法的抑制性能比较，模拟中仍采用稳态平均相对误差SMRE或输出噪信比NSR。来衡量，即160次迭代的10lg(ek-sk)2/s2k(dB)的平均值。采用的参数与[1]相同，即取样频率fn=1/T=200Hz，输入信噪比为-5dB，ECG的等效幅度为0.113858,n0=0.286337，n1=c=1.030814,no、n1为no(t)、n1(t）的幅度。不同参数α、γ时的收敛曲线如图2所示。由图2曲线可见，曲线①最佳，此时α1=0.986601,γ1=0.00065,AIC的输出波形如图3所示，图3波形基本上与AIC的输入心电图S(t)的波形一样，说明心电图中的50Hz干扰基本上完全被抑制，此时AIC的SMRE=-33dB，收敛迭代次数为640。 
　　　　　　　　　
图2不同参数的收敛曲线　　　　　　　　　　　　　　　图3AIC的输出波形
　　为比较LMS、VMS和VSS三种算法抑制性能，通过调整各算法的参数在两种情况下进行比较，一是在同样的SMRE下比较各种算法的收敛迭代次数，如图4所示；二是在同样的收敛迭代次数下比较各种算法的SMRE，如图5所示。 
　　　　　　
图4SMRE相同   　　　　　　　　　　　　图5收敛迭代次数相同
　　图4、图5中曲线2是变步长变动量因子LMS算法（VSVMS），由于此算法的运算量最大，且抑制性能较差，不适合用于抑制ECG中50Ｈz干扰，所以本文中不进行讨论。由图4、图5可得到三种算法的抑制性能列于下表1，在表中也比较了它们的运算量和调节参数。
表1各种算法的性能比较
算法类型SMRE=-29dB时的收敛迭代次数收敛迭代次数为640时的SMRE（dB）运算量调节参数数
LMS700-27.21小1
VMS320-28大2
VSS320-31.4稍大于VMS2

　　由表１可见，抑制性能最好的是VSS算法， 而且VSS算法的运算量稍大于VMS算法。
4小结
　　由理论分析和模拟实验结果均表明，VSS算法在抑制ECG中50HZ干扰 的抑制性能优于LMS和其它LMS改进的算法，而且VSS 逄法的运算量和硬件增加不多，因此，总的来说，VSS算法是最佳的选择。
　　王晋龙、倪敬华、陈学、宋鸿升等同学参加了模拟实验，在此表示感谢！
参考文献：
[1]杜丽冰．改善ECG中50Hz干扰的抑制性能[J]．环境技术，1999年，(1)，P8～10
[2]R.H.Kwong & E.W.Johnston, A Variable Step Sije LMS Algorithm［Ｊ］. IEEE.SP-40,NO.7,1992,PP1633～1642〗 
作者简介：杜丽冰(1937-)，女，江苏江阴人，教授，主要从事通信理论、通信与电子系统的电磁兼容和干扰抑制的教学和科研工作。
作者单位：北京邮电大学电信工程学院171信箱， 北京100876）
收稿日期：1999-07-09
